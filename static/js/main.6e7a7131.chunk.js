(this.webpackJsonpbattleship=this.webpackJsonpbattleship||[]).push([[0],{14:function(e,t,r){},15:function(e,t,r){},16:function(e,t,r){"use strict";r.r(t);var a=r(0),i=r(1),n=r.n(i),c=r(8),o=r.n(c),s=r(3),p=r(4),h=r(2),l=function(e,t,r,a,i){var n=[];if("horizontal"===a)for(var c=0;c<r;c++){var o={x:e+c,y:t,hit:!1};n.push(o)}else for(var s=0;s<r;s++){var p={x:e,y:t-s,hit:!1};n.push(p)}return null!==e&&e+r>10&&"horizontal"===a||t-r<-1&&"vertical"===a?null:{getShipLength:function(){return r},getOrientation:function(){return a},positions:n,hit:function(e,t){n.forEach((function(r){r.x===e&&r.y===t&&n.splice(n.indexOf(r),1,{x:r.x,y:r.y,hit:!0})}))},isSunk:function(){return n.every((function(e){return e.hit}))},placed:!1,getShipNumber:function(){return i}}},u=function(e){var t=[];if("Player"===e){var r=l(void 0,void 0,5,"horizontal"),a=l(void 0,void 0,4,"horizontal"),i=l(void 0,void 0,3,"horizontal"),n=l(void 0,void 0,3,"horizontal"),c=l(void 0,void 0,2,"horizontal");t.push(r,a,i,n,c)}return{getName:function(){return e},playerShips:t,rotateHorizontalShip:function(e){var r=l(t[e].x,t[e].y,t[e].getShipLength(),"vertical");return t.splice(e,1,r)},rotateVerticalShip:function(e){var r=l(t[e].x,t[e].y,t[e].getShipLength(),"horizontal");return t.splice(e,1,r)}}};var d=function(){for(var e=[],t=0,r=function(r){var a=r;var i={empty:!0,x:r>9?a=r%10:a,y:(r%10===0&&r>9&&(t+=1),9-t)};e.push(i)},a=0;a<100;a++)r(a);return e};function j(){return Math.floor(10*Math.random())}function b(){return Math.floor(10*Math.random())}function f(){return Math.floor(10*Math.random())%2===0?"horizontal":"vertical"}function m(e){for(var t={x:j(),y:b(),length:e,orientation:f()};null!==t.x&&t.x+e>10&&"horizontal"===t.orientation||t.y-e<-1&&"vertical"===t.orientation||void 0===t;)t.x=j(),t.y=b(),t.orientation=f();return t}var y=function(e){var t=m(2),r=m(3),a=m(3),i=m(4),n=m(5);function c(e){return[e.x,e.y,e.length,e.orientation]}[e.placeShip.apply(e,Object(s.a)(c(t))),e.placeShip.apply(e,Object(s.a)(c(r))),e.placeShip.apply(e,Object(s.a)(c(a))),e.placeShip.apply(e,Object(s.a)(c(i))),e.placeShip.apply(e,Object(s.a)(c(n)))].forEach((function(t){for(;!0!==t;){var r=m(t.getShipLength());t=e.placeShip(r.x,r.y,r.length,r.orientation)}}))},O=function(){var e=d(),t=[];return{gameBoardArray:e,playerShipPositions:t,placeShip:function(r,a,i,n,c){var o=l(r,a,i,n,c);if(null!==o){var p=Object(s.a)(o.positions),h=!1;return t.forEach((function(e){if(p.some((function(t){return t.x===e.x&&t.y===e.y})))return h=!0})),h?o:(p.forEach((function(r){e.forEach((function(a){var i={empty:!1,ship:o};r.x===a.x&&r.y===a.y&&(i.x=a.x,i.y=a.y,e.splice(e.indexOf(a),1,i),t.push(r))}))})),!0)}},removeShip:function(r,a){if(e[a].ship){var i=e[a].ship.positions;e.forEach((function(a){i.forEach((function(i){var n={empty:!0,x:i.x,y:i.y};a.ship&&a.ship.getShipNumber()===r&&a.x===n.x&&a.y===n.y&&e.splice(e.indexOf(a),1,n),t.forEach((function(e){e===i&&t.splice(t.indexOf(e,1))}))}))}))}},receiveAttack:function(t,r,a){var i=e[t],n={empty:!1,hit:!0,ship:e[t].ship},c={empty:!1,sunk:!0,hit:!0,ship:e[t].ship};if(!i.ship)return e.splice(t,1,{empty:!1,miss:!0,hit:!1});i.ship.hit(r,a),i.ship.isSunk()?e.forEach((function(t){t.ship===i.ship&&e.splice(e.indexOf(t),1,c)})):e.splice(t,1,n)},placeShips:function(){y(this)}}},v=function(e){return Object(a.jsx)("div",{id:e.preparing?"board-wrapper__player-board-wrapper--preparing":"board-wrapper__player-board-wrapper",children:e.playerBoard.gameBoardArray.map((function(t,r){return t.ship&&t.sunk?Object(a.jsx)("div",{className:"player-ship-block--sunk",id:r,"data-x":e.setX(r),"data-y":e.setY(r)},r):t.hit?Object(a.jsx)("div",{className:"player-ship-block--hit",id:r,"data-x":e.setX(r),"data-y":e.setY(r),children:"!"},r):t.ship&&!t.hit?Object(a.jsx)("div",{className:"player-ship-block",id:r,"data-x":e.setX(r),"data-y":e.setY(r),"data-shipnumber":t.ship.getShipNumber(),onClick:e.removeShipFromBoard},r):t.miss?Object(a.jsx)("div",{className:"miss-block"},r):Object(a.jsx)(a.Fragment,{children:!t.ship&&Object(a.jsx)("div",{className:"empty-block",id:r,"data-x":e.setX(r),"data-y":e.setY(r),onClick:e.placeChosenShip},r)})}))})},x=function(e){return Object(a.jsx)("div",{id:"board-wrapper__computer-board-wrapper",children:e.computerBoardArray.map((function(t,r){return t.ship&&t.sunk?Object(a.jsx)("div",{className:"enemy-ship-block--sunk",id:r,"data-x":e.setX(r),"data-y":e.setY(r)},r):t.hit?Object(a.jsx)("div",{className:"enemy-ship-block--hit",id:r,"data-x":e.setX(r),"data-y":e.setY(r),children:"!"},r):t.ship&&!t.hit?Object(a.jsx)("div",{className:"enemy-ship-block",id:r,"data-x":e.setX(r),"data-y":e.setY(r),onClick:e.playerAttackHandler,children:"s"},r):t.miss?Object(a.jsx)("div",{className:"miss-block"},r):Object(a.jsx)(a.Fragment,{children:!t.ship&&Object(a.jsx)("div",{className:"empty-block",id:r,"data-x":e.setX(r),"data-y":e.setY(r),onClick:e.playerAttackHandler},r)})}))})},g=function(e){return Object(a.jsxs)("div",{id:"player-ships-wrapper",children:[Object(a.jsx)("div",{id:"player-ships-wrapper__instructions-wrapper",children:Object(a.jsx)("h2",{children:"Place your ships"})}),Object(a.jsx)("div",{id:"player-ships-wrapper__ships",children:e.player.playerShips.map((function(t,r){return Object(a.jsx)(a.Fragment,{children:!1===t.placed&&Object(a.jsxs)("div",{className:"player-ships-wrapper__ship--"+t.getOrientation(),"data-shipnumber":r,"data-length":t.getShipLength(),"data-orientation":t.getOrientation(),onClick:e.chooseShip,children:[Object(a.jsx)("button",{onClick:e.rotateShip,className:"ship__rotate-ship-button",children:"Rotate"}),Object(a.jsx)(a.Fragment,{children:t.positions.map((function(t,r){return Object(a.jsx)("div",{className:"player-ship-block--docked",id:r,"data-x":e.setX(r),"data-y":e.setY(r)},r)}))})]},r)})}))})]})},S=function(e){return Object(a.jsx)(g,{player:e.player,setX:e.setX,setY:e.setY,chooseShip:e.chooseShip,rotateShip:e.rotateShip,mouseMove:e.mouseMove})},k=function(e){return Object(a.jsx)("div",{className:"error-wrapper",children:"Unable to place ship. Check for collision and available space."})},A=function(e){return Object(a.jsx)("div",{className:"error-wrapper",children:"Place all ships before starting the game."})},N=function(e){function t(e){return e>9?e%10:e}function r(e){return e>89?0:9-Math.floor(e/10)}return Object(a.jsxs)("div",{id:"game-wrapper",children:[Object(a.jsx)("div",{id:"header-wrapper",children:Object(a.jsx)("h1",{children:"Battleship"})}),Object(a.jsxs)("div",{id:"board-wrapper",children:[Object(a.jsx)(v,{player:e.player,playerBoard:e.playerBoard,setX:t,setY:r,placeChosenShip:e.placeChosenShip,removeShipFromBoard:e.removeShipFromBoard,preparing:e.preparing}),e.preparing&&Object(a.jsxs)(a.Fragment,{children:[e.placementError&&Object(a.jsx)(k,{}),e.placeAllShipsError&&Object(a.jsx)(A,{}),Object(a.jsx)(S,{player:e.player,setX:t,setY:r,chooseShip:e.chooseShip,rotateShip:e.rotateShip}),Object(a.jsx)("button",{onClick:e.placeRandomShips,children:"test"}),Object(a.jsx)("button",{id:"start-game-button",onClick:e.startGame,children:"Start game"})]}),!e.preparing&&Object(a.jsxs)(a.Fragment,{children:[!e.gameOver&&Object(a.jsx)(a.Fragment,{children:e.playerTurn?Object(a.jsx)("h2",{id:"turn-display",children:"Player turn"}):Object(a.jsx)("h2",{id:"turn-display",children:"Computer turn"})}),e.gameOver&&Object(a.jsx)(a.Fragment,{children:e.playerWins?Object(a.jsxs)("div",{id:"game-over-info",children:["You win!"," ",Object(a.jsx)("button",{onClick:e.restartGame,children:"Restart"})]}):Object(a.jsxs)("div",{id:"game-over-info",children:["You lose!"," ",Object(a.jsx)("button",{onClick:e.restartGame,children:"Restart"})]})}),Object(a.jsx)(x,{computerBoardArray:e.computerBoard.gameBoardArray,setX:t,setY:r,playerAttackHandler:e.playerAttackHandler,placeChosenShip:e.placeChosenShip})]})]})]})},B=function(e){var t=Object(i.useState)(u("Player")),r=Object(h.a)(t,2),n=r[0],c=r[1],o=Object(i.useState)(u("Computer")),l=Object(h.a)(o,2),d=l[0],j=l[1],b=Object(i.useState)(O()),f=Object(h.a)(b,2),m=f[0],y=f[1],v=Object(i.useState)(O()),x=Object(h.a)(v,2),g=x[0],S=x[1],k=Object(i.useState)(!0),A=Object(h.a)(k,2),B=A[0],C=A[1],w=Object(i.useState)([]),E=Object(h.a)(w,2),Y=E[0],X=E[1],_=Object(i.useState)(!1),z=Object(h.a)(_,2),F=z[0],M=z[1],I=Object(i.useState)(!0),P=Object(h.a)(I,2),H=P[0],L=P[1],G=Object(i.useState)(!1),R=Object(h.a)(G,2),T=R[0],J=R[1],V=Object(i.useState)(),W=Object(h.a)(V,2),U=W[0],q=W[1],D=Object(i.useState)(0),K=Object(h.a)(D,2),Q=K[0],Z=K[1],$=Object(i.useState)(!1),ee=Object(h.a)($,2),te=ee[0],re=ee[1],ae=Object(i.useState)(!1),ie=Object(h.a)(ae,2),ne=ie[0],ce=ie[1],oe=Object(i.useState)(),se=Object(h.a)(oe,2),pe=se[0],he=se[1];function le(){var e=[];m.gameBoardArray.forEach((function(t){t.ship&&!e.includes(t.ship)&&e.push(t.ship)})),H&&5===e.length?(g.placeShips(),L(!1),ce(!1)):ce(!0)}return Object(i.useEffect)((function(){B||F||setTimeout((function(){!function(){var e=0;function t(){return e=Math.floor(100*Math.random())}for(X([].concat(Object(s.a)(Y),[t()]));Y.includes(e)&&Y.length<100;)X([].concat(Object(s.a)(Y),[t()]));y((function(t){return t.receiveAttack(e,parseInt(t.gameBoardArray[e].x),parseInt(t.gameBoardArray[e].y)),Object(p.a)({},t)})),C(!0)}()}),500)}),[B]),Object(i.useEffect)((function(){if(!H){var e=[],t=[];g.gameBoardArray.forEach((function(t){t.ship&&!e.includes(t.ship)&&e.push(t.ship)})),m.gameBoardArray.forEach((function(e){e.ship&&!t.includes(e.ship)&&t.push(e.ship)})),e.every((function(e){return e.isSunk()}))&&(he(!0),M(!0)),t.every((function(e){return e.isSunk()}))&&(he(!1),M(!0))}}),[m,g,H]),Object(a.jsx)(N,{player:n,playerBoard:m,computer:d,computerBoard:g,playerAttackHandler:function(e){!B||H||F||S((function(t){return t.receiveAttack(e.target.id,parseInt(e.target.getAttribute("data-x")),parseInt(e.target.getAttribute("data-y"))),C(!1),Object(p.a)({},t)}))},chooseShip:function(e){if(!T){var t={shipLength:parseInt(e.target.getAttribute("data-length")),orientation:e.target.getAttribute("data-orientation")};J(!0),Z(parseInt(e.target.getAttribute("data-shipnumber"))),q(t),e.target.className+="--selected"}},placeChosenShip:function(e){T&&y((function(t){var r=parseInt(e.target.getAttribute("data-x")),a=parseInt(e.target.getAttribute("data-y"));return!0===t.placeShip(r,a,U.shipLength,U.orientation,Q)?(n.playerShips[Q].placed=!0,re(!1),J(!1)):re(!0),Object(p.a)({},t)}))},rotateShip:function(e){if(e.stopPropagation(),!T){var t=e.target.parentNode.getAttribute("data-shipnumber"),r=e.target.parentNode.getAttribute("data-orientation");c("horizontal"===r?function(e){return e.rotateHorizontalShip(t),Object(p.a)({},e)}:function(e){return e.rotateVerticalShip(t),Object(p.a)({},e)})}},preparing:H,startGame:le,placeRandomShips:function(){m.placeShips(),le()},playerTurn:B,restartGame:function(){L(!0),C(!0),X([]),M(!1),he(""),c(u("Player")),j(u("Computer")),y(O()),S(O())},removeShipFromBoard:function(e){H&&!T&&y((function(t){var r=parseInt(e.target.getAttribute("data-shipnumber")),a=parseInt(e.target.id);return n.playerShips[r].placed=!1,m.removeShip(r,a),Object(p.a)({},t)}))},placementError:te,placeAllShipsError:ne,playerWins:pe,gameOver:F})};r(14),r(15);var C=function(){return Object(a.jsx)("div",{className:"App",children:Object(a.jsx)(B,{})})};o.a.render(Object(a.jsx)(n.a.StrictMode,{children:Object(a.jsx)(C,{})}),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.6e7a7131.chunk.js.map