(this.webpackJsonpbattleship=this.webpackJsonpbattleship||[]).push([[0],{14:function(t,e,i){},15:function(t,e,i){},16:function(t,e,i){"use strict";i.r(e);var r=i(0),a=i(1),n=i.n(a),c=i(8),o=i.n(c),s=i(4),p=i(3),h=i(2),l=function(t,e,i,r,a){var n=[];if("horizontal"===r)for(var c=0;c<i;c++){var o={x:t+c,y:e,hit:!1};n.push(o)}else for(var s=0;s<i;s++){var p={x:t,y:e-s,hit:!1};n.push(p)}return null!==t&&t+i>10&&"horizontal"===r||e-i<-1&&"vertical"===r?null:{getShipLength:function(){return i},getOrientation:function(){return r},positions:n,hit:function(t,e){n.forEach((function(i){i.x===t&&i.y===e&&n.splice(n.indexOf(i),1,{x:i.x,y:i.y,hit:!0})}))},isSunk:function(){return n.every((function(t){return t.hit}))},placed:!1,getShipNumber:function(){return a}}},u=function(){var t=[],e=[],i=0;!function(){for(var e=function(e){var r=e;var a={empty:!0,x:e>9?r=e%10:r,y:(e%10===0&&e>9&&(i+=1),9-i)};t.push(a)},r=0;r<100;r++)e(r)}();return{gameBoardArray:t,playerShipPositions:e,placeShip:function(i,r,a,n,c){var o=l(i,r,a,n,c);if(null!==o){var p={empty:!1,ship:o},h=Object(s.a)(p.ship.positions),u=!1;if(e.forEach((function(t){if(h.some((function(e){return e.x===t.x&&e.y===t.y})))return u=!0})),null!==p.ship&&!u)return h.forEach((function(i){t.forEach((function(r){i.x===r.x&&i.y===r.y&&(t.splice(t.indexOf(r),1,p),e.push(i))}))})),!0}},removeShip:function(i,r){if(t[r].ship){console.log(t[r].ship.positions);var a=t[r].ship.positions;t.forEach((function(r){a.forEach((function(a){var n={empty:!0,x:a.x,y:a.y};r.ship&&r.ship.getShipNumber()===i&&t.splice(t.indexOf(r),1,n),e.forEach((function(t){t===a&&e.splice(e.indexOf(e,1))}))}))}))}},receiveAttack:function(e,i,r){var a=t[e],n={empty:!1,hit:!0,ship:t[e].ship},c={empty:!1,sunk:!0,hit:!0,ship:t[e].ship};if(!a.ship)return t.splice(e,1,{empty:!1,miss:!0,hit:!1});a.ship.hit(i,r),a.ship.isSunk()?t.forEach((function(e){e.ship===a.ship&&t.splice(t.indexOf(e),1,c)})):t.splice(e,1,n)},listShips:function(){t.forEach((function(t){if(t.ship)return t}))}}},d=function(t){var e=u(),i=l(void 0,void 0,5,"horizontal"),r=l(void 0,void 0,4,"horizontal"),a=l(void 0,void 0,3,"horizontal"),n=l(void 0,void 0,3,"horizontal"),c=l(void 0,void 0,2,"horizontal"),o=[];return o.push(i,r,a,n,c),{getName:function(){return t},playerBoard:e,makePlay:function(t,e,i,r){var a=Math.floor(100*Math.random());void 0!==e?t.placeShip(e,i,r):t.receiveAttack(a)},removeShip:function(t){console.log(o[t]);var e=o.filter((function(e){return e!==o[t]}));return o=Object(s.a)(e)},playerShips:o,rotateHorizontalShip:function(t){var e=l(o[t].x,o[t].y,o[t].getShipLength(),"vertical");return o.splice(t,1,e)},rotateVerticalShip:function(t){var e=l(o[t].x,o[t].y,o[t].getShipLength(),"horizontal");return o.splice(t,1,e)}}},f=function(t){return Object(r.jsx)("div",{id:"board-wrapper__player-board-wrapper",children:t.player.playerBoard.gameBoardArray.map((function(e,i){return e.ship&&e.sunk?Object(r.jsx)("div",{className:"friendly-ship-block",id:i,"data-x":t.setX(i),"data-y":t.setY(i),children:"Sunk Ship"},i):e.hit?Object(r.jsx)("div",{className:"friendly-ship-block",id:i,"data-x":t.setX(i),"data-y":t.setY(i),children:"Hit"},i):e.ship&&!e.hit?Object(r.jsx)("div",{className:"friendly-ship-block",id:i,"data-x":t.setX(i),"data-y":t.setY(i),"data-shipnumber":e.ship.getShipNumber(),onClick:t.removeShipFromBoard,children:"Ship"},i):e.miss?Object(r.jsx)("div",{className:"miss-block",children:"Miss"},i):Object(r.jsx)(r.Fragment,{children:!e.ship&&Object(r.jsx)("div",{className:"empty-block",id:i,"data-x":t.setX(i),"data-y":t.setY(i),onClick:t.placeChosenShip},i)})}))})},b=function(t){return Object(r.jsx)("div",{id:"board-wrapper__computer-board-wrapper",children:t.computerBoardArray.map((function(e,i){return e.ship&&e.sunk?Object(r.jsx)("div",{className:"enemy-ship-block",id:i,"data-x":t.setX(i),"data-y":t.setY(i),children:"Sunk Ship"},i):e.hit?Object(r.jsx)("div",{className:"enemy-ship-block",id:i,"data-x":t.setX(i),"data-y":t.setY(i),children:"Hit"},i):e.ship&&!e.hit?Object(r.jsx)("div",{className:"enemy-ship-block",id:i,"data-x":t.setX(i),"data-y":t.setY(i),onClick:t.playerAttackHandler,children:"Ship"},i):e.miss?Object(r.jsx)("div",{className:"miss-block",children:"Miss"},i):Object(r.jsx)(r.Fragment,{children:!e.ship&&Object(r.jsx)("div",{className:"empty-block",id:i,"data-x":t.setX(i),"data-y":t.setY(i),onClick:t.playerAttackHandler},i)})}))})},j=function(t){return Object(r.jsx)("div",{id:"player-ships-wrapper",children:t.player.playerShips.map((function(e,i){return Object(r.jsx)(r.Fragment,{children:!1===e.placed&&Object(r.jsxs)("div",{className:"player-ships-wrapper__ship--"+e.getOrientation(),"data-shipnumber":i,"data-length":e.getShipLength(),"data-orientation":e.getOrientation(),onClick:t.chooseShip,children:[Object(r.jsx)("button",{onClick:t.rotateShip,children:"Rotate"}),Object(r.jsx)(r.Fragment,{children:e.positions.map((function(e,i){return Object(r.jsxs)("div",{className:"player-ship-block",id:i,"data-x":t.setX(i),"data-y":t.setY(i),children:["position ",i]},i)}))})]},i)})}))})},m=function(t){return Object(r.jsx)(j,{player:t.player,setX:t.setX,setY:t.setY,chooseShip:t.chooseShip,rotateShip:t.rotateShip,mouseMove:t.mouseMove})},y=function(t){return Object(r.jsx)("div",{id:"error-wrapper",children:"Unable to place ship. Check for collision and space."})},O=function(t){return Object(r.jsxs)("div",{id:"game-wrapper",children:[Object(r.jsxs)("div",{id:"board-wrapper",children:[Object(r.jsx)(f,{player:t.player,setX:t.setX,setY:t.setY,placeChosenShip:t.placeChosenShip,removeShipFromBoard:t.removeShipFromBoard}),Object(r.jsx)(b,{computerBoardArray:t.computer.playerBoard.gameBoardArray,setX:t.setX,setY:t.setY,playerAttackHandler:t.playerAttackHandler,placeChosenShip:t.placeChosenShip})]}),t.preparing&&Object(r.jsxs)(r.Fragment,{children:[t.placementError&&Object(r.jsx)(y,{}),Object(r.jsx)(m,{player:t.player,setX:t.setX,setY:t.setY,chooseShip:t.chooseShip,rotateShip:t.rotateShip}),Object(r.jsx)("button",{onClick:t.startGame,children:"Start game"})]}),Object(r.jsx)("button",{onClick:t.placeTestShip,children:"Test"}),Object(r.jsx)("button",{onClick:t.computerAttack,children:"Attacked"})]})},v=function(t){var e=Object(a.useState)(d("Player")),i=Object(h.a)(e,2),n=i[0],c=i[1],o=Object(a.useState)(d("PC")),l=Object(h.a)(o,2),u=l[0],f=l[1],b=Object(a.useState)(!0),j=Object(h.a)(b,2),m=j[0],y=j[1],v=Object(a.useState)([]),S=Object(h.a)(v,2),x=S[0],g=S[1],k=Object(a.useState)(!1),A=Object(h.a)(k,2),B=(A[0],A[1]),N=Object(a.useState)(!0),X=Object(h.a)(N,2),Y=X[0],C=X[1],E=Object(a.useState)(!1),w=Object(h.a)(E,2),z=w[0],M=w[1],F=Object(a.useState)(),H=Object(h.a)(F,2),I=H[0],L=H[1],_=Object(a.useState)(0),P=Object(h.a)(_,2),T=P[0],G=P[1],J=Object(a.useState)(!1),V=Object(h.a)(J,2),R=V[0],U=V[1];function q(){var t=0;function e(){return t=Math.floor(100*Math.random())}for(g([].concat(Object(s.a)(x),[e()]));x.includes(t)&&x.length<100;)g([].concat(Object(s.a)(x),[e()]));c((function(e){return e.playerBoard.receiveAttack(t),Object(p.a)({},e)})),y(!0)}return Object(a.useEffect)((function(){n.playerShips.length||setTimeout((function(){q()}),0)}),[m]),Object(a.useEffect)((function(){m||setTimeout((function(){q()}),0)}),[m]),Object(a.useEffect)((function(){if(!Y){var t=[],e=[];u.playerBoard.gameBoardArray.forEach((function(e){e.ship&&!t.includes(e.ship)&&t.push(e.ship)})),n.playerBoard.gameBoardArray.forEach((function(t){t.ship&&!e.includes(t.ship)&&e.push(t.ship)})),t.every((function(t){return t.isSunk()}))&&(console.log("all sunk! winner!"),B(!0)),e.every((function(t){return t.isSunk()}))&&(console.log("all sunk! loser!"),B(!0))}}),[u]),Object(r.jsx)(O,{player:n,computer:u,placeTestShip:function(){f((function(t){return t.playerBoard.placeShip(3,5,3,"horizontal"),Object(p.a)({},t)}))},playerAttackHandler:function(t){f((function(e){if(m&&!Y)return e.playerBoard.receiveAttack(t.target.id,parseInt(t.target.getAttribute("data-x")),parseInt(t.target.getAttribute("data-y"))),y(!1),Object(p.a)({},e)}))},setX:function(t){return t>9?t%10:t},setY:function(t){return t>89?0:9-Math.floor(t/10)},computerAttack:q,chooseShip:function(t){var e={shipLength:parseInt(t.target.getAttribute("data-length")),orientation:t.target.getAttribute("data-orientation")};M(!0),G(parseInt(t.target.getAttribute("data-shipnumber"))),L(e)},placeChosenShip:function(t){c((function(e){if(z){var i=parseInt(t.target.getAttribute("data-x")),r=parseInt(t.target.getAttribute("data-y")),a=e.playerBoard.placeShip(i,r,I.shipLength,I.orientation,T);return M(!1),a?(n.playerShips[T].placed=!0,U(!1)):U(!0),Object(p.a)({},e)}}))},rotateShip:function(t){if(t.stopPropagation(),!z){var e=t.target.parentNode.getAttribute("data-shipnumber"),i=t.target.parentNode.getAttribute("data-orientation");c("horizontal"===i?function(t){return t.rotateHorizontalShip(e),Object(p.a)({},t)}:function(t){return t.rotateVerticalShip(e),Object(p.a)({},t)})}},preparing:Y,startGame:function(){C(!1)},removeShipFromBoard:function(t){c((function(e){if(Y){var i=parseInt(t.target.getAttribute("data-shipnumber")),r=parseInt(t.target.id);return console.log(r),n.playerShips[i].placed=!1,n.playerBoard.removeShip(i,r),Object(p.a)({},e)}}))},placementError:R})};i(14),i(15);var S=function(){return Object(r.jsx)("div",{className:"App",children:Object(r.jsx)(v,{})})};o.a.render(Object(r.jsx)(n.a.StrictMode,{children:Object(r.jsx)(S,{})}),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.f0a52cb3.chunk.js.map